{
  "name": "lobster_transformer_long",
  "timestamp": "2025-09-26T09:54:22.470102Z",
  "duration_sec": 27.31160879135132,
  "config": {
    "name": "lobster_transformer_long",
    "venue": "lobster",
    "symbol": "AAPL",
    "dataset": "data/runs/events/lobster_aapl_2012-06-21_sample.npz",
    "num_types": 2,
    "seed": 2024,
    "training": {
      "window_size": 128,
      "stride": 64,
      "batch_size": 256,
      "epochs": 15,
      "lr": 0.0008,
      "delta_weight": 1.0,
      "embed_dim": 64,
      "hidden_dim": 128,
      "backbone": "transformer",
      "mlp_layers": 2,
      "measure_runtime": true,
      "verbose": true
    }
  },
  "train_history": [
    {
      "loss": 5.482884605344987,
      "ce": 0.594050053871187,
      "mse": 4.888834621776714,
      "acc": 0.7361033922869877,
      "mae": 0.7629543436093584
    },
    {
      "loss": 5.043571664234092,
      "ce": 0.4542982779460395,
      "mse": 4.589273436920855,
      "acc": 0.8495864526463761,
      "mae": 1.0376017692907036
    },
    {
      "loss": 4.937930842983055,
      "ce": 0.4279374519351943,
      "mse": 4.509993435083798,
      "acc": 0.8520492115902231,
      "mae": 0.9775486507268408
    },
    {
      "loss": 4.919368407485887,
      "ce": 0.4295059425707276,
      "mse": 4.489862387872485,
      "acc": 0.8528664988503493,
      "mae": 0.9699065466071681
    },
    {
      "loss": 4.8991746226911435,
      "ce": 0.4179030762735303,
      "mse": 4.481271660334277,
      "acc": 0.8533023853890832,
      "mae": 0.9735616723263809
    },
    {
      "loss": 4.887045303510256,
      "ce": 0.41662053958089607,
      "mse": 4.470424730800837,
      "acc": 0.8534985343315135,
      "mae": 0.9980629653429337
    },
    {
      "loss": 4.872537725079618,
      "ce": 0.4132563838030106,
      "mse": 4.459281250036041,
      "acc": 0.8522998463499951,
      "mae": 0.9987055787347303
    },
    {
      "loss": 4.861266863046411,
      "ce": 0.41142804074265593,
      "mse": 4.449838901283952,
      "acc": 0.8525722754367038,
      "mae": 0.9962025726500267
    },
    {
      "loss": 4.853442290513928,
      "ce": 0.4132228986862467,
      "mse": 4.440219383264064,
      "acc": 0.8530408534658428,
      "mae": 0.9718509879300293
    },
    {
      "loss": 4.843871866425085,
      "ce": 0.41143690808435607,
      "mse": 4.432434855174947,
      "acc": 0.853106236446653,
      "mae": 1.0017580828007344
    },
    {
      "loss": 4.835406130736951,
      "ce": 0.4085896622002237,
      "mse": 4.426816398133786,
      "acc": 0.8528773960138176,
      "mae": 0.9836933526281234
    },
    {
      "loss": 4.830599909569606,
      "ce": 0.4085986448482384,
      "mse": 4.4220012717764705,
      "acc": 0.8526158640905772,
      "mae": 0.9763625200235378
    },
    {
      "loss": 4.822009700385974,
      "ce": 0.40679065791788194,
      "mse": 4.415219075705734,
      "acc": 0.853106236446653,
      "mae": 0.9812390858097138
    },
    {
      "loss": 4.818185677263844,
      "ce": 0.4058457652420539,
      "mse": 4.412339859288759,
      "acc": 0.8536293002931337,
      "mae": 0.985853310898798
    },
    {
      "loss": 4.815249655151566,
      "ce": 0.4063381684691999,
      "mse": 4.408911423561213,
      "acc": 0.8537600662547539,
      "mae": 0.972565326792311
    }
  ],
  "val_history": [
    {
      "loss": 4.921113014221191,
      "acc": 0.8513802587348477,
      "mae": 0.9798488113731283
    },
    {
      "loss": 4.795951843261719,
      "acc": 0.8556076194356728,
      "mae": 1.0427206551772437
    },
    {
      "loss": 4.770074367523193,
      "acc": 0.8560150758887644,
      "mae": 0.9311563725552613
    },
    {
      "loss": 4.7674736976623535,
      "acc": 0.8562697361719466,
      "mae": 1.003362908411429
    },
    {
      "loss": 4.730018138885498,
      "acc": 0.8562188041153102,
      "mae": 0.9406039706313029
    },
    {
      "loss": 4.731973648071289,
      "acc": 0.8560150758887644,
      "mae": 1.0264836746842212
    },
    {
      "loss": 4.709963798522949,
      "acc": 0.8555057553223999,
      "mae": 0.9798445338761842
    },
    {
      "loss": 4.708812236785889,
      "acc": 0.8553529591524905,
      "mae": 0.952186338112458
    },
    {
      "loss": 4.704985618591309,
      "acc": 0.8557604156055821,
      "mae": 1.0012927988438423
    },
    {
      "loss": 4.6922101974487305,
      "acc": 0.8557094835489457,
      "mae": 0.9663317220765
    },
    {
      "loss": 4.69378662109375,
      "acc": 0.8558622797188551,
      "mae": 0.9816286480085565
    },
    {
      "loss": 4.68590784072876,
      "acc": 0.8557094835489457,
      "mae": 0.9852406460094734
    },
    {
      "loss": 4.679512977600098,
      "acc": 0.8559641438321279,
      "mae": 0.9760295039854334
    },
    {
      "loss": 4.682944297790527,
      "acc": 0.8559132117754915,
      "mae": 0.9664282144494245
    },
    {
      "loss": 4.68295431137085,
      "acc": 0.8560660079454009,
      "mae": 0.9627342476698584
    }
  ],
  "test_metrics": {
    "loss": 4.42526388168335,
    "acc": 0.8577629719362003,
    "mae": 0.8991551837270341
  },
  "rescaling": {
    "sample_size": 19812,
    "ks_statistic": 0.5903517236234009,
    "ks_pvalue": 0.0,
    "mean_rescaled": 97.91107940673828,
    "var_rescaled": 101882040.0,
    "qq_theoretical": [
      2.5237548425862773e-05,
      0.005034862436834507,
      0.010120696666840286,
      0.015181280998404932,
      0.020319114377687603,
      0.025431705559430032,
      0.030622612385241676,
      0.03578829045175862,
      0.0410333786612372,
      0.04625325764408944,
      0.05155367023358247,
      0.05688232696879732,
      0.062185816123327714,
      0.06757158382068404,
      0.07293222043945126,
      0.07837633656142896,
      0.08379536564174866,
      0.08929910831085901,
      0.09477781598290305,
      0.1003425057827402,
      0.10593833471556482,
      0.11150922301880814,
      0.11716806730787131,
      0.12280204533364848,
      0.12852534039545438,
      0.13422385348487648,
      0.1400130843467821,
      0.14577762808423733,
      0.15163433169730436,
      0.15752553846151787,
      0.16339222195474057,
      0.16935331379233848,
      0.1752900066902451,
      0.18132266154948473,
      0.18733105493610536,
      0.19343701193131607,
      0.19951885891239052,
      0.20569992133345774,
      0.2119194270306238,
      0.21811507861614926,
      0.22441252692887373,
      0.23068631176555884,
      0.23706368104099185,
      0.24341759497916082,
      0.24987693985482273,
      0.2563130562079895,
      0.2628565115854788,
      0.2693769851915846,
      0.27600677047242167,
      0.2826808033211562,
      0.2893322656293948,
      0.2960961319250943,
      0.3028377304920139,
      0.3096938815820068,
      0.3165280929121095,
      0.32347908186947033,
      0.33040848595269084,
      0.33745697328375235,
      0.34455549466142976,
      0.3516330192005576,
      0.3588332519130575,
      0.36601291869581604,
      0.3733178198740512,
      0.380602620301809,
      0.3880152779420268,
      0.3954083367817305,
      0.4029319775829427,
      0.4105126529336001,
      0.4180745588115804,
      0.4257713449320719,
      0.4334499679391179,
      0.44126647703732697,
      0.44906547670652147,
      0.4570054922184383,
      0.4649287029356786,
      0.47299619052141895,
      0.4811292921624457,
      0.48924675228199016,
      0.4975136534115017,
      0.5057657632558151,
      0.514170939866385,
      0.5225622418594683,
      0.5311103983687722,
      0.5396456687385196,
      0.5483417538014936,
      0.5570260189054423,
      0.5658752426187429,
      0.5748034747759555,
      0.5837216493686315,
      0.5928113815438781,
      0.6018923465343797,
      0.6111495290502369,
      0.6203993380627071,
      0.6298302562674559,
      0.6392553069966505,
      0.6488666068964885,
      0.6585711810943408,
      0.6682723840765881,
      0.6781680662334707,
      0.6880622105093984,
      0.698156678702096,
      0.7082515946533583,
      0.7185529991676919,
      0.7288570037390554,
      0.7393740066024104,
      0.7500027934891775,
      0.7606377632060681,
      0.7714962226826145,
      0.782363508555916,
      0.7934617857246851,
      0.8045717642129339,
      0.8159206915596544,
      0.8272844502099697,
      0.8388956111376475,
      0.8506431764875978,
      0.8624108149560649,
      0.8744395881272473,
      0.886492327165764,
      0.8988161013508911,
      0.9111680986951789,
      0.9238017074455689,
      0.9364682022801663,
      0.9494276268316845,
      0.9624250528122545,
      0.9757275436178633,
      0.9892093790962784,
      1.0027378718417488,
      1.0165913870218057,
      1.0304980586762331,
      1.0447443285381872,
      1.0590509309362994,
      1.0737128752852496,
      1.0884430925256532,
      1.1035456977860656,
      1.1188798938256355,
      1.1342959574578577,
      1.150112815467551,
      1.1660218767003299,
      1.1823527695678027,
      1.1987874024183196,
      1.215666864700501,
      1.2326629819793933,
      1.2501291495127342,
      1.2679058153027118,
      1.285821603944327,
      1.3042502098775475,
      1.3228353139856528,
      1.3419655004383892,
      1.3612718723285724,
      1.3811591738799895,
      1.4012450591266123,
      1.4219518762043108,
      1.443096548110817,
      1.464479652252865,
      1.4865531673838541,
      1.508896683212223,
      1.5319843992418816,
      1.5553786608471494,
      1.5795782688635083,
      1.6041269848877078,
      1.6295510058484266,
      1.655374036958906,
      1.682152983501074,
      1.7096688204152017,
      1.7376763087816747,
      1.766786208782428,
      1.7964646460044973,
      1.8273646789537794,
      1.858926112771896,
      1.8918508974683623,
      1.9255504784868083,
      1.9607839978785202,
      1.9973043974583957,
      2.0348230078441825,
      2.0742059276258913,
      2.11478526564197,
      2.157517680381331,
      2.2017015738492645,
      2.2484063028258747,
      2.2968976830437584,
      2.3483891083965243,
      2.4026765212343526,
      2.459490421450302,
      2.5203549598507373,
      2.5844961119841363,
      2.653751886640585,
      2.727391093705963,
      2.80772330680975,
      2.8941645258501847,
      2.989793954055278,
      3.0955448006629394,
      3.2125612590491284,
      3.346540580012607,
      3.4996165687101004,
      3.682439504306235,
      3.9038293285018,
      4.191928676152625,
      4.593228846961509,
      5.283885366209005,
      10.587190274268977
    ],
    "qq_empirical": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      4.9038848374038935e-05,
      7.81509661464952e-05,
      0.00010465743980603293,
      0.00013033501454629004,
      0.00016042661445681006,
      0.00018504347826819867,
      0.00021643562649842352,
      0.0002508563920855522,
      0.00028476229635998607,
      0.00032900963560678065,
      0.0003757248050533235,
      0.0004240198468323797,
      0.0004653923970181495,
      0.0005373873864300549,
      0.0005841655656695366,
      0.0006532063125632703,
      0.0007021818310022354,
      0.000771665945649147,
      0.0008427362190559506,
      0.0009021313162520528,
      0.0009862955193966627,
      0.001091120531782508,
      0.0011994916712865233,
      0.0013117685448378325,
      0.0014233611291274428,
      0.0015509641962125897,
      0.001713644014671445,
      0.0018634273437783122,
      0.0020423803944140673,
      0.002192980842664838,
      0.00236952630802989,
      0.0025962041690945625,
      0.002820499474182725,
      0.0031254373025149107,
      0.0034467957448214293,
      0.0038488206919282675,
      0.004283564630895853,
      0.004616301506757736,
      0.005088002420961857,
      0.00561634311452508,
      0.006230117287486792,
      0.006856885738670826,
      0.007735746446996927,
      0.008564072661101818,
      0.009484906680881977,
      0.010498573072254658,
      0.011857003904879093,
      0.013146745041012764,
      0.014826205559074879,
      0.016972782090306282,
      0.018611546605825424,
      0.02118770219385624,
      0.023721301928162575,
      0.027053041383624077,
      0.03070840798318386,
      0.03438128903508186,
      0.03895048052072525,
      0.04439541697502136,
      0.05053805559873581,
      0.05803445726633072,
      0.0671369805932045,
      0.07625532895326614,
      0.08709795027971268,
      0.09883666783571243,
      0.11143949627876282,
      0.12830626964569092,
      0.14446230232715607,
      0.16490551829338074,
      0.18588554859161377,
      0.20630261301994324,
      0.2322201430797577,
      0.2654862403869629,
      0.2903655469417572,
      0.3206244111061096,
      0.351737916469574,
      0.3869871497154236,
      0.4218156635761261,
      0.45973649621009827,
      0.4991028308868408,
      0.5403591990470886,
      0.5862177014350891,
      0.6409462094306946,
      0.6850882768630981,
      0.7284405827522278,
      0.7811748385429382,
      0.8371909856796265,
      0.8931609392166138,
      0.9516428112983704,
      1.0158743858337402,
      1.076699137687683,
      1.1390223503112793,
      1.2203083038330078,
      1.3109241724014282,
      1.3941795825958252,
      1.4803857803344727,
      1.5693531036376953,
      1.668079137802124,
      1.7651216983795166,
      1.8439089059829712,
      1.957074522972107,
      2.0670547485351562,
      2.171105146408081,
      2.3202626705169678,
      2.43355655670166,
      2.5751826763153076,
      2.7285282611846924,
      2.8843629360198975,
      3.0719923973083496,
      3.2626986503601074,
      3.4633469581604004,
      3.679206132888794,
      3.9451074600219727,
      4.208168983459473,
      4.46113395690918,
      4.748725891113281,
      5.065579414367676,
      5.4283223152160645,
      5.852160930633545,
      6.275752544403076,
      6.750265598297119,
      7.3286566734313965,
      7.824029922485352,
      8.57598876953125,
      9.338168144226074,
      10.696935653686523,
      12.148621559143066,
      13.718765258789062,
      16.628231048583984,
      21.89059066772461,
      81.13152313232422,
      1406372.125
    ]
  },
  "runtime": {
    "cpu_seconds": 0.057736873626708984
  },
  "device": "cpu",
  "params": 125443,
  "metadata": {
    "venue": "lobster",
    "symbol": "AAPL",
    "backbone": "transformer",
    "num_types": 2,
    "dataset": "data/runs/events/lobster_aapl_2012-06-21_sample.npz",
    "seed": 2024
  }
}