{
  "name": "lobster_transformer",
  "timestamp": "2025-09-26T09:23:23.393063Z",
  "duration_sec": 9.431627035140991,
  "config": {
    "name": "lobster_transformer",
    "venue": "lobster",
    "symbol": "AAPL",
    "dataset": "data/runs/events/lobster_aapl_2012-06-21_sample.npz",
    "num_types": 2,
    "seed": 2024,
    "training": {
      "window_size": 128,
      "stride": 64,
      "batch_size": 256,
      "epochs": 5,
      "lr": 0.0008,
      "delta_weight": 1.0,
      "embed_dim": 64,
      "hidden_dim": 128,
      "backbone": "transformer",
      "mlp_layers": 2,
      "measure_runtime": true,
      "verbose": true
    }
  },
  "train_history": [
    {
      "loss": 5.482884605344987,
      "ce": 0.594050053871187,
      "mse": 4.888834621776714,
      "acc": 0.7361033922869877,
      "mae": 0.7629543436093584
    },
    {
      "loss": 5.043571664234092,
      "ce": 0.4542982779460395,
      "mse": 4.589273436920855,
      "acc": 0.8495864526463761,
      "mae": 1.0376017692907036
    },
    {
      "loss": 4.937930842983055,
      "ce": 0.4279374519351943,
      "mse": 4.509993435083798,
      "acc": 0.8520492115902231,
      "mae": 0.9775486507268408
    },
    {
      "loss": 4.919368407485887,
      "ce": 0.4295059425707276,
      "mse": 4.489862387872485,
      "acc": 0.8528664988503493,
      "mae": 0.9699065466071681
    },
    {
      "loss": 4.8991746226911435,
      "ce": 0.4179030762735303,
      "mse": 4.481271660334277,
      "acc": 0.8533023853890832,
      "mae": 0.9735616723263809
    }
  ],
  "val_history": [
    {
      "loss": 4.921113014221191,
      "acc": 0.8513802587348477,
      "mae": 0.9798488113731283
    },
    {
      "loss": 4.795951843261719,
      "acc": 0.8556076194356728,
      "mae": 1.0427206551772437
    },
    {
      "loss": 4.770074367523193,
      "acc": 0.8560150758887644,
      "mae": 0.9311563725552613
    },
    {
      "loss": 4.7674736976623535,
      "acc": 0.8562697361719466,
      "mae": 1.003362908411429
    },
    {
      "loss": 4.730018138885498,
      "acc": 0.8562188041153102,
      "mae": 0.9406039706313029
    }
  ],
  "test_metrics": {
    "loss": 4.472213268280029,
    "acc": 0.8579143953159701,
    "mae": 0.8826001523697758
  },
  "rescaling": {
    "sample_size": 19812,
    "ks_statistic": 0.5830047668145686,
    "ks_pvalue": 0.0,
    "mean_rescaled": 3713.142333984375,
    "var_rescaled": 4046440192.0,
    "qq_theoretical": [
      2.5237548425862773e-05,
      0.005034862436834507,
      0.010120696666840286,
      0.015181280998404932,
      0.020319114377687603,
      0.025431705559430032,
      0.030622612385241676,
      0.03578829045175862,
      0.0410333786612372,
      0.04625325764408944,
      0.05155367023358247,
      0.05688232696879732,
      0.062185816123327714,
      0.06757158382068404,
      0.07293222043945126,
      0.07837633656142896,
      0.08379536564174866,
      0.08929910831085901,
      0.09477781598290305,
      0.1003425057827402,
      0.10593833471556482,
      0.11150922301880814,
      0.11716806730787131,
      0.12280204533364848,
      0.12852534039545438,
      0.13422385348487648,
      0.1400130843467821,
      0.14577762808423733,
      0.15163433169730436,
      0.15752553846151787,
      0.16339222195474057,
      0.16935331379233848,
      0.1752900066902451,
      0.18132266154948473,
      0.18733105493610536,
      0.19343701193131607,
      0.19951885891239052,
      0.20569992133345774,
      0.2119194270306238,
      0.21811507861614926,
      0.22441252692887373,
      0.23068631176555884,
      0.23706368104099185,
      0.24341759497916082,
      0.24987693985482273,
      0.2563130562079895,
      0.2628565115854788,
      0.2693769851915846,
      0.27600677047242167,
      0.2826808033211562,
      0.2893322656293948,
      0.2960961319250943,
      0.3028377304920139,
      0.3096938815820068,
      0.3165280929121095,
      0.32347908186947033,
      0.33040848595269084,
      0.33745697328375235,
      0.34455549466142976,
      0.3516330192005576,
      0.3588332519130575,
      0.36601291869581604,
      0.3733178198740512,
      0.380602620301809,
      0.3880152779420268,
      0.3954083367817305,
      0.4029319775829427,
      0.4105126529336001,
      0.4180745588115804,
      0.4257713449320719,
      0.4334499679391179,
      0.44126647703732697,
      0.44906547670652147,
      0.4570054922184383,
      0.4649287029356786,
      0.47299619052141895,
      0.4811292921624457,
      0.48924675228199016,
      0.4975136534115017,
      0.5057657632558151,
      0.514170939866385,
      0.5225622418594683,
      0.5311103983687722,
      0.5396456687385196,
      0.5483417538014936,
      0.5570260189054423,
      0.5658752426187429,
      0.5748034747759555,
      0.5837216493686315,
      0.5928113815438781,
      0.6018923465343797,
      0.6111495290502369,
      0.6203993380627071,
      0.6298302562674559,
      0.6392553069966505,
      0.6488666068964885,
      0.6585711810943408,
      0.6682723840765881,
      0.6781680662334707,
      0.6880622105093984,
      0.698156678702096,
      0.7082515946533583,
      0.7185529991676919,
      0.7288570037390554,
      0.7393740066024104,
      0.7500027934891775,
      0.7606377632060681,
      0.7714962226826145,
      0.782363508555916,
      0.7934617857246851,
      0.8045717642129339,
      0.8159206915596544,
      0.8272844502099697,
      0.8388956111376475,
      0.8506431764875978,
      0.8624108149560649,
      0.8744395881272473,
      0.886492327165764,
      0.8988161013508911,
      0.9111680986951789,
      0.9238017074455689,
      0.9364682022801663,
      0.9494276268316845,
      0.9624250528122545,
      0.9757275436178633,
      0.9892093790962784,
      1.0027378718417488,
      1.0165913870218057,
      1.0304980586762331,
      1.0447443285381872,
      1.0590509309362994,
      1.0737128752852496,
      1.0884430925256532,
      1.1035456977860656,
      1.1188798938256355,
      1.1342959574578577,
      1.150112815467551,
      1.1660218767003299,
      1.1823527695678027,
      1.1987874024183196,
      1.215666864700501,
      1.2326629819793933,
      1.2501291495127342,
      1.2679058153027118,
      1.285821603944327,
      1.3042502098775475,
      1.3228353139856528,
      1.3419655004383892,
      1.3612718723285724,
      1.3811591738799895,
      1.4012450591266123,
      1.4219518762043108,
      1.443096548110817,
      1.464479652252865,
      1.4865531673838541,
      1.508896683212223,
      1.5319843992418816,
      1.5553786608471494,
      1.5795782688635083,
      1.6041269848877078,
      1.6295510058484266,
      1.655374036958906,
      1.682152983501074,
      1.7096688204152017,
      1.7376763087816747,
      1.766786208782428,
      1.7964646460044973,
      1.8273646789537794,
      1.858926112771896,
      1.8918508974683623,
      1.9255504784868083,
      1.9607839978785202,
      1.9973043974583957,
      2.0348230078441825,
      2.0742059276258913,
      2.11478526564197,
      2.157517680381331,
      2.2017015738492645,
      2.2484063028258747,
      2.2968976830437584,
      2.3483891083965243,
      2.4026765212343526,
      2.459490421450302,
      2.5203549598507373,
      2.5844961119841363,
      2.653751886640585,
      2.727391093705963,
      2.80772330680975,
      2.8941645258501847,
      2.989793954055278,
      3.0955448006629394,
      3.2125612590491284,
      3.346540580012607,
      3.4996165687101004,
      3.682439504306235,
      3.9038293285018,
      4.191928676152625,
      4.593228846961509,
      5.283885366209005,
      10.587190274268977
    ],
    "qq_empirical": [
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      5.8460034779272974e-05,
      9.12395553314127e-05,
      0.0001193183779832907,
      0.00014716248551849276,
      0.00017752755957189947,
      0.00020995104569010437,
      0.00024110452795866877,
      0.0002749738341663033,
      0.00029633467784151435,
      0.00033176166471093893,
      0.0003810066555161029,
      0.00042913921060971916,
      0.0004895137972198427,
      0.0005410580197349191,
      0.0005820547812618315,
      0.0006286639254540205,
      0.0007018371252343059,
      0.0007909854757599533,
      0.0008559921407140791,
      0.000944906088989228,
      0.00104133237618953,
      0.0011223559267818928,
      0.001205245847813785,
      0.0012844799784943461,
      0.001390568446367979,
      0.0014941268600523472,
      0.0016370384255424142,
      0.0018076783744618297,
      0.002026325324550271,
      0.002228023484349251,
      0.0024660006165504456,
      0.0027104439213871956,
      0.0029637846164405346,
      0.0032724463380873203,
      0.0036244175862520933,
      0.003945712465792894,
      0.0043581100180745125,
      0.004844921641051769,
      0.0053330762311816216,
      0.005998970475047827,
      0.0066812848672270775,
      0.007458323612809181,
      0.00821528211236,
      0.009101174771785736,
      0.010117908008396626,
      0.011238610371947289,
      0.01259047444909811,
      0.014388835057616234,
      0.016479602083563805,
      0.01882614567875862,
      0.021064532920718193,
      0.024402903392910957,
      0.027505135163664818,
      0.03178178891539574,
      0.036177586764097214,
      0.04135121777653694,
      0.04706278443336487,
      0.053424522280693054,
      0.060923341661691666,
      0.06943922489881516,
      0.08127301186323166,
      0.09114174544811249,
      0.10512910038232803,
      0.12105925381183624,
      0.1363617479801178,
      0.1548357754945755,
      0.1782921552658081,
      0.19864358007907867,
      0.22488486766815186,
      0.2509913444519043,
      0.28254956007003784,
      0.3169732987880707,
      0.34950846433639526,
      0.3767537772655487,
      0.4138241112232208,
      0.4483742117881775,
      0.48417919874191284,
      0.524430513381958,
      0.5639141798019409,
      0.6007551550865173,
      0.6434407830238342,
      0.6941928863525391,
      0.7523111701011658,
      0.8077782392501831,
      0.876017153263092,
      0.9284816384315491,
      0.9871951937675476,
      1.040147304534912,
      1.1185038089752197,
      1.1833107471466064,
      1.2685983180999756,
      1.3486698865890503,
      1.4243550300598145,
      1.513123869895935,
      1.6030553579330444,
      1.7106844186782837,
      1.8249765634536743,
      1.9462790489196777,
      2.061035394668579,
      2.2055952548980713,
      2.3644373416900635,
      2.499530792236328,
      2.6766934394836426,
      2.8591432571411133,
      3.030503749847412,
      3.2125370502471924,
      3.449982166290283,
      3.6495399475097656,
      3.9186272621154785,
      4.2035322189331055,
      4.4811530113220215,
      4.771890640258789,
      5.154825210571289,
      5.543155670166016,
      5.975850582122803,
      6.468005657196045,
      7.0458784103393555,
      7.663761615753174,
      8.513337135314941,
      9.418445587158203,
      10.555047988891602,
      12.122572898864746,
      14.231372833251953,
      16.986352920532227,
      20.385665893554688,
      32.176395416259766,
      122.0703125,
      801.08642578125,
      6347.65625,
      164794.921875,
      2709350.5
    ]
  },
  "runtime": {
    "cpu_seconds": 0.06308913230895996
  },
  "device": "cpu",
  "params": 125443,
  "metadata": {
    "venue": "lobster",
    "symbol": "AAPL",
    "backbone": "transformer",
    "num_types": 2,
    "dataset": "data/runs/events/lobster_aapl_2012-06-21_sample.npz",
    "seed": 2024
  }
}